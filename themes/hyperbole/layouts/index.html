{{ define "main" }}

<main class="entries">
    {{ range (.Paginate .Pages).Pages }}
        <div class="entries-item">
            <h2>{{ .Title }}</h2>
            <div class="entries-item-video">

                <div data-id="{{ .Params.YoutubeId }}" class="entries-item-video-placeholder">
                    <img src="https://i.ytimg.com/vi/{{ .Params.YoutubeId }}/hqdefault.jpg" alt="video thumbnail">
                    <!-- <img src="https://img.youtube.com/vi/{{ .Params.YoutubeId }}/maxresdefault.jpg" alt="video thumbnail"> -->
                </div>

                <!-- <iframe width="690" height="380" src="https://www.youtube.com/embed/{{ .Params.YoutubeId }}"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
                </iframe> -->
            </div>
            <div class="entries-item-opinion">
                <a href="{{ .Permalink }}">
                    Published on <time datetime="{{ .Date }}">{{ .Date.Format "January 2, 2006" }}</time>
                </a>
            </div>
        </div>
    {{ end }}
</main>

<div class="pagination">
    <div class="pagination-body">
        <div class="paginator-body-prev">
            {{ if .Paginator.HasPrev }}
                <a href="{{ .Paginator.Prev.URL }}">← Newer</a>
            {{ end }}
        </div>

        <div class="pagination-body-current">{{ .Paginator.PageNumber }}</div>

        <div class="pagination-body-next">
            {{ if .Paginator.HasNext }}
                <a href="{{ .Paginator.Next.URL }}">Older →</a>
            {{ end }}
        </div>
    </div>
</div>

<script>
    const videoElems = document.querySelectorAll('.entries-item-video-placeholder');
    for (const elem of videoElems) {
        elem.addEventListener('click', function (ev) {
            const imageElem = ev.target;
            const parentElem = ev.target.parentNode;
            const youtubeId = ev.target.parentNode.dataset.id;
            const iframeElem = document.createElement('iframe');
            iframeElem.width = 690;
            iframeElem.height = 380;
            iframeElem.src = 'https://www.youtube.com/embed/' + youtubeId + '?autoplay=1';
            iframeElem.frameBorder = 0;
            iframeElem.allow = 'autoplay; encrypted-media';
            iframeElem.allowFullscreen = true;
            imageElem.style.display = 'none';
            parentElem.appendChild(iframeElem);
        })
    }
</script>

{{ end }}
